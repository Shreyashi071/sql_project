select * from Data1
select * from project.dbo.Data2

-- no of rows into our dataset
select count(*) from project..Data1
select count(*) from project..Data1

-- dataset for jharkhand and bihar
select * from Data1 where state in ('Jharkhand', 'bihar')

-- population of India
select sum(Population) as Population from Data2

-- avg growth
select avg(Growth)*100 as avg_growth from Data1

-- avg growth by state in asc orderby growth
select state, avg(Growth)*100 as avg_growth from Data1 group by state order by avg_growth

-- avg sex ratio / using round func to remove decimal no
select state, round(avg(Sex_Ratio),0) as avg_Sex_Ratio from Data1 group by state order by avg_Sex_Ratio desc

-- avg litreacy rate
select state, round(avg(Literacy),0) as avg_Literacy from Data1 group by state having round(avg(Literacy),0)>90  order by avg_Literacy desc

--top 3 states showing highest growth ratio
select top 3 state, avg(Growth)*100 as avg_growth from Data1 group by state order by avg_growth desc

--bottom 3 states showing lowest sex ratio
select top 3 state, round(avg(Sex_Ratio),0) as avg_Sex_Ratio from Data1 group by state order by avg_Sex_Ratio asc 

-- top & bottom 3 states in literacy rate
drop table if exists #topstates
create table #topstates
(State nvarchar(255),
topstates float(8))

insert into #topstates
select top 3 state, round(avg(Literacy),0) as avg_Literacy from Data1 group by state order by avg_Literacy desc

select * from #topstates order by #topstates.topstates desc;

drop table if exists #bottomstates
create table #bottomstates
(State nvarchar(255),
bottomstates float(8))

insert into #bottomstates
select top 3 state, round(avg(Literacy),0) as avg_Literacy from Data1 group by state order by avg_Literacy asc

select * from #bottomstates order by #bottomstates.bottomstates asc;

select * from (select top 3 * from #topstates order by #topstates.topstates desc) a
union
select * from(select top 3 * from #bottomstates order by #bottomstates.bottomstates asc) b ;
